<?php

namespace IOGames\Jesker;

use PHPUnit\Framework\TestCase;

/**
 * Class PacketMatcherTest
 */
class PacketMatcherTest extends TestCase
{
    /**
     * @var PacketMatcher
     */
    protected $packetMatcher;

    /**
     * Prepare.
     */
    public function setUp()
    {
        parent::setUp();

        $this->packetMatcher = new PacketMatcher();
    }

    /**
     * @param $rule
     * @param $data
     * @param $doesMatch
     * @dataProvider dataProvider
     */
    public function testMatch($rule, $data, $doesMatch)
    {
        $this->packetMatcher->setRule($rule);
        $matchResult = $this->packetMatcher->doesMatch($data);
        $this->assertEquals($doesMatch, $matchResult);
    }

    /**
     * @return array
     */
    public function dataProvider()
    {
        return [
            [
                ['13', '00', '00', '00', 'b0', '04', '00', '00', '03', '00', '00', '00', '61', '64', '6d', '69', '6e', '31', '33', '33', '37', '00', '00'],
                ['13', '00', '00', '00', 'b0', '04', '00', '00', '03', '00', '00', '00', '61', '64', '6d', '69', '6e', '31', '33', '33', '37', '00', '00'],
                true,
            ],
            [
                ['13', '00', '00', '00', 'b0', '04', '00', '00', '03', '00', '00', '00', '61', '64', '6d', '69', '6e', '31', '33', '33', '37', '00', '00'],
                ['12', '00', '00', '00', 'b0', '04', '00', '00', '03', '00', '00', '00', '61', '64', '6d', '69', '6e', '31', '33', '33', '37', '00', '00'],
                false,
            ],
            [
                ['12', '00', '00', '00', 'b0', '04', '00', '00', '03', '00', '00', '00', '61', '64', '6d', '69', '6e', '31', '33', '33', '37', '00', '00'],
                ['12', '00', '00', '00', 'b0', '04', '00', '00', '03', '00', '00', '00', '61', '64', '6d', '69', '6e', '31', '33', '33', '37', '00', '00', '00'],
                false,
            ],
            [
                ['12', '00', '00', '00', 'b0', ['04', '03'], '00', '00', '03', '00', '00', '00', '61', '64', '6d', '69', '6e', '31', '33', '33', '37', '00', '00'],
                ['12', '00', '00', '00', 'b0', '04', '00', '00', '03', '00', '00', '00', '61', '64', '6d', '69', '6e', '31', '33', '33', '37', '00', '00'],
                true,
            ],
            [
                ['12', '00', '00', '00', 'b0', ['04', '03'], '00', '00', '03', '00', '00', '00', '61', '64', '6d', '69', '6e', '31', '33', '33', '37', '00', '00'],
                ['12', '00', '00', '00', 'b0', '03', '00', '00', '03', '00', '00', '00', '61', '64', '6d', '69', '6e', '31', '33', '33', '37', '00', '00'],
                true,
            ],
            [
                ['12', '00', '00', '00', 'b0', ['04', '03'], '00', '00', '03', '00', '00', '00', '61', '64', '6d', '69', '6e', '31', '33', '33', '37', '00', '00'],
                ['12', '00', '00', '00', 'b0', '02', '00', '00', '03', '00', '00', '00', '61', '64', '6d', '69', '6e', '31', '33', '33', '37', '00', '00'],
                false,
            ],
            [
                ['12', '00', '00', '00', '*', ['04', '03'], '00', '00', '03', '00', '00', '00', '61', '64', '6d', '69', '6e', '31', '33', '33', '37', '00', '00'],
                ['12', '00', '00', '00', 'b0', '03', '00', '00', '03', '00', '00', '00', '61', '64', '6d', '69', '6e', '31', '33', '33', '37', '00', '00'],
                true,
            ],
            [
                ['12', '00', '00', '00', '*', ['04', '03'], '00', '00', '03', '00', '00', '00', '61', '64', '6d', '69', '6e', '31', '33', '33', '37', '00', '00'],
                ['12', '00', '00', '00', '02', '03', '00', '00', '03', '00', '00', '00', '61', '64', '6d', '69', '6e', '31', '33', '33', '37', '00', '00'],
                true,
            ],
        ];
    }
}